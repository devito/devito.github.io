<demo-tag>
    <template shadowrootmode="open">
        <p>This is the shadow dom</p>
        <slot></slot>
    </template>
    <script>console.log("added first demo-tag");</script>
    <p>This is light dom</p>
</demo-tag>
<script type="module">
    class DemoTag extends HTMLElement {
        static shadow = undefined;
 
        constructor() {
            super();
           
            this.SetupShadow();
        }

        SetupShadow() {
            if (!DemoTag.shadow) {
                const supportsDeclarative = HTMLElement.prototype.hasOwnProperty("attachInternals");
                const internals = supportsDeclarative ? this.attachInternals() : undefined;

                // check for a Declarative Shadow Root.
                DemoTag.shadow = internals?.shadowRoot;
            }
        }

        connectedCallback() {
            console.log("Custom element added to page.");
            this.SetupShadow();          

            const toggle = () => {
                console.log("I'm clicked!");
            };

            DemoTag.shadow?.firstElementChild.addEventListener("click", toggle);
        }        
    }
      
    customElements.define("demo-tag", DemoTag);
</script>
<demo-tag>
    <script>console.log("added second demo-tag");</script>
    <p>I am made after being a custom element</p>
</demo-tag>