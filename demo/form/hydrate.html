<demo-tag>
    <template shadowrootmode="open">
        <p>This is the shadow dom</p>
        <slot></slot>
    </template>
    <script>console.log("added first demo-tag");</script>
    <p>This is light dom</p>
</demo-tag>
<script type="module">
    class DemoTag extends HTMLElement {
        static template = undefined;
 
        constructor() {
            super();
            this.SetupShadow();
        }

        SetupShadow() {
            if (!DemoTag.template) {
                const supportsDeclarative = HTMLElement.prototype.hasOwnProperty("attachInternals");
                const internals = supportsDeclarative ? this.attachInternals() : undefined;

                // save the template for future use
                DemoTag.template = internals?.shadowRoot?.innerHTML;
            }
            else {
                // check if there is internal
                const internals = this.attachInternals();
                if (!internals?.shadowRoot) {
                    this.attachShadow({mode: 'open'});
                    this.shadowRoot.innerHTML = DemoTag.template;
                }                
            }
        }

        connectedCallback() {
            console.log("Custom element added to page.");                      

            const toggle = () => {
                console.log("I'm clicked!");
            };

            this.shadowRoot.firstElementChild.addEventListener("click", toggle);
        }        
    }
      
    customElements.define("demo-tag", DemoTag);
</script>
<demo-tag>
    <script>console.log("added second demo-tag");</script>
    <p>I am made after being a custom element</p>
</demo-tag>